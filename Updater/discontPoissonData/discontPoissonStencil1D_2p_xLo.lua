local Lin = require "Lib.Linalg"
local function stencilFn(dx, D, N, val)
  local _M = {}

  _M[1] = Lin.Vec(3)
  _M[1][1] = -36.0/(12.72792206135786*dx[1]^2*N-1.414213562373095*dx[1]^2*D)*val
  _M[1][2] = 55.42562584220407/(12.72792206135786*dx[1]^2*N-1.414213562373095*dx[1]^2*D)*val
  _M[1][3] = -53.66563145999496/(12.72792206135786*dx[1]^2*N-1.414213562373095*dx[1]^2*D)*val
  _M[2] = Lin.Mat(3,3)
  _M[2][1][1] = -(1.0*(552960.0*N-417792.0*D))/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[2][1][2] = ((-702353.5306724098*N)-251854.0438269753*D)/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[2][1][3] = -(1.0*(552960.0*N-956160.0*D))/(206076.0248063807*dx[1]^2*N-22897.33608959785*dx[1]^2*D)
  _M[2][2][1] = -(1.0*(595936.3290553781*N+482424.6473305442*D))/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[2][2][2] = (2985984.0*D-8589312.0*N)/(589824.0*dx[1]^2*N-65536.0*dx[1]^2*D)
  _M[2][2][3] = -(1.0*(4.494353148292644e+7*D-7768455.718043322*N))/(6594432.793804181*dx[1]^2*N-732714.7548671312*dx[1]^2*D)
  _M[2][3][1] = (604489.6727653831*D-659443.279380418*N)/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[2][3][2] = -(1.0*(2998246.819566393*N+1633965.197964755*D))/(589824.0*dx[1]^2*N-65536.0*dx[1]^2*D)
  _M[2][3][3] = (3.274752e+7*D-1.2294144e+8*N)/(2949120.0*dx[1]^2*N-327680.0*dx[1]^2*D)
  _M[3] = Lin.Mat(3,3)
  _M[3][1][1] = (552960.0*N-122880.0*D)/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[3][1][2] = (166720.2825333498*D-702353.5306724098*N)/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[3][1][3] = (552960.0*N-149760.0*D)/(206076.0248063807*dx[1]^2*N-22897.33608959785*dx[1]^2*D)
  _M[3][2][1] = (595936.3290553781*N+28377.92043120848*D)/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[3][2][2] = -(1.0*(2813952.0*N+233472.0*D))/(589824.0*dx[1]^2*N-65536.0*dx[1]^2*D)
  _M[3][2][3] = (1.457915662153336e+7*N+2731374.841503817*D)/(6594432.793804181*dx[1]^2*N-732714.7548671312*dx[1]^2*D)
  _M[3][3][1] = -(1.0*(164860.8198451045*D-659443.279380418*N))/(147456.0*dx[1]^2*N-16384.0*dx[1]^2*D)
  _M[3][3][2] = (872505.688233607*D-3093429.258282788*N)/(589824.0*dx[1]^2*N-65536.0*dx[1]^2*D)
  _M[3][3][3] = -(1.0*(2641920.0*D-6819840.0*N))/(2949120.0*dx[1]^2*N-327680.0*dx[1]^2*D)
  return(_M)
end

return(stencilFn)